# Mappificator

This is a pile of bodging scripts for playing around with Minecraft modding mappings. It is currently able to work with Official, MCP, Yarn, MCP Config Tsrg, and Fabric Intermediary mappings, and provides a host of methods and parsers to analyze and mix various mapping sets.

#### The "Complete" MCP Mapping Export

The primary use for this at the moment is to generate a 100% mapped mcp snapshot export, for use in Forge 1.16.4 development. All required materials to make this are downloaded locally, and the mapping is built and uploaded to the user's maven local. For legal reasons these mappings cannot be redistributed as is and have to be built in situ.

This involves:
- Using official field and method names. These are 100% complete and have the advantage of a guarantee of no field / method shadowing conflicts.
- Adding parameter names and comments from **both** the most recent MCP Bot export, and the current work in progress MMS 1.16.3 Mapping Spreadsheet.
- Filling in any unmapped parameters with autogenerated names based on parameter types. These are checked for uniqueness with other parameters in the method (suffixed with consecutive ints to avoid conflicts if they appear), and are also suffixed with an underscore to both identify the auto generated parameters, and prevent conflicts with local variables.
- In addition, parameters are manually verified by me, and corrections are included in `build/corrections-1.16.4.json`, which can also serve as a place to manually map particularly important parameters. If the generated mappings fail to compile due to parameter issues, the CLI can be used to reverse engineer srg names from their mapped counterparts - and then add resolutions to the aforementioned corrections file.

In order to get this export:

- You must install [Maven](https://maven.apache.org/). (Python will invoke `mvn` via command line so it must be on your path.)
  - To check if Maven is functional, run `mvn --version` in a console window.
- Run `mappificator.py` with the working directory `/<Mappificator Project Folder>/src/`
  - To change the output mcp snapshot version, use the `--version` flag.
  - If advanced comments are desired (Including the SRG and MCP name if it exists as a comment to every mapped field and method), use the `--advanced-comments` flag.
  - In order to run a CLI which is useful for reverse engineering names, run `mappificator.py --cli`

In order to use this (or any other custom mcp export) in a mod dev environment, you need to edit your `build.gradle`:

Add `mavenLocal()` to your repositories:

```
repositories {
    mavenLocal()
}
```

And change your mapping version and channel to the one produced by this export.

```
minecraft {
    mappings channel: 'snapshot', version: '<VERSION>'
```

Note: as this mapping scheme is based on the official mappings, it is possible to use the official mappings in a build server where more readable source is not a concern and the source code will be perfectly cross-compatible. For example, switching to official mappings when an environment variable is present:

```
minecraft {
    def officialVersion = System.getenv("OFFICIAL_MAPPINGS")
    if (officialVersion == null) {
        mappings channel: 'snapshot', version: mappificator_version
    } else {
        mappings channel: 'official', version: mc_version
    }
```